# ะะพะบัะผะตะฝัะฐัะธั ะฟะพ ัะฐะทะฒะตัััะฒะฐะฝะธั (Deployment)

ะะพะบัะผะตะฝัะฐัะธั ะฟะพ ะฝะฐัััะพะนะบะต ะธ ะธัะฟะพะปัะทะพะฒะฐะฝะธั CI/CD ะดะปั ะฟัะพะตะบัะฐ Colaba.

## ๐ ะกัััะบัััะฐ ะดะพะบัะผะตะฝัะฐัะธะธ

### ะัะฝะพะฒะฝัะต ะดะพะบัะผะตะฝัั

1. **[CI_CD.md](./CI_CD.md)** - ะัะฝะพะฒะฝะฐั ะดะพะบัะผะตะฝัะฐัะธั ะฟะพ ะฐััะธัะตะบัััะต CI/CD
   - ะะฟะธัะฐะฝะธะต ัะฐะฑะพัั pipeline
   - ะขัะตะฑะพะฒะฐะฝะธั ะบ ัะตัะฒะตัั
   - ะฃััะฐะฝะพะฒะบะฐ self-hosted runner
   - ะงัะพ ะดะตะฟะปะพะธััั ะฝะฐ ัะตัะฒะตั

2. **[GITHUB_ACTIONS_SETUP.md](./GITHUB_ACTIONS_SETUP.md)** - ะะพะดัะพะฑะฝะฐั ะธะฝััััะบัะธั ะฟะพ ะฝะฐัััะพะนะบะต GitHub Actions
   - ะะฐัััะพะนะบะฐ ัะตะฟะพะทะธัะพัะธั
   - ะฃััะฐะฝะพะฒะบะฐ self-hosted runner
   - ะะฐัััะพะนะบะฐ ะฟะตัะตะผะตะฝะฝัั ะพะบััะถะตะฝะธั
   - Troubleshooting

3. **[QUICK_START.md](./QUICK_START.md)** - ะัััััะน ััะฐัั
   - ะัะฐัะบะฐั ะธะฝััััะบัะธั ะดะปั ะฑััััะพะน ะฝะฐัััะพะนะบะธ
   - ะัะฝะพะฒะฝัะต ัะฐะณะธ
   - ะัะพะฒะตัะบะฐ ัะฐะฑะพัะพัะฟะพัะพะฑะฝะพััะธ

4. **[VARIABLES_REFERENCE.md](./VARIABLES_REFERENCE.md)** - ะกะฟัะฐะฒะพัะฝะธะบ ะฟะตัะตะผะตะฝะฝัั
   - ะะพะปะฝัะน ัะฟะธัะพะบ ะฒัะตั ะฟะตัะตะผะตะฝะฝัั ะพะบััะถะตะฝะธั
   - ะะฟะธัะฐะฝะธะต ะบะฐะถะดะพะน ะฟะตัะตะผะตะฝะฝะพะน
   - ะัะธะผะตัั ะทะฝะฐัะตะฝะธะน
   - ะะตะฝะตัะฐัะธั ัะตะบัะตัะฝัั ะทะฝะฐัะตะฝะธะน

5. **[CHECKLIST.md](./CHECKLIST.md)** - ะงะตะบะปะธัั ะฝะฐัััะพะนะบะธ
   - ะะพัะฐะณะพะฒะฐั ะฟัะพะฒะตัะบะฐ ะฒัะตั ะบะพะผะฟะพะฝะตะฝัะพะฒ
   - ะัะพะฒะตัะบะฐ ัะฐะฑะพัะพัะฟะพัะพะฑะฝะพััะธ
   - Troubleshooting

### ะัะฟะพะผะพะณะฐัะตะปัะฝัะต ัะฐะนะปั

- **[ENV_PRODUCTION.example](./ENV_PRODUCTION.example)** - ะัะธะผะตั ัะฐะนะปะฐ `.env` ะดะปั ะฟัะพะดะฐะบัะตะฝะฐ
  - ะัะต ะฟะตัะตะผะตะฝะฝัะต ั ะบะพะผะผะตะฝัะฐัะธัะผะธ
  - ะะฑัะทะฐัะตะปัะฝัะต ะธ ะพะฟัะธะพะฝะฐะปัะฝัะต ะฟะตัะตะผะตะฝะฝัะต
  - ะัะธะผะตัั ะทะฝะฐัะตะฝะธะน

## ๐ ะัััััะน ััะฐัั

ะัะปะธ ะฒั ะฒะฟะตัะฒัะต ะฝะฐัััะฐะธะฒะฐะตัะต CI/CD:

1. **ะะฐัะฝะธัะต ั [QUICK_START.md](./QUICK_START.md)** - ะบัะฐัะบะฐั ะธะฝััััะบัะธั
2. **ะัะฟะพะปัะทัะนัะต [CHECKLIST.md](./CHECKLIST.md)** - ะดะปั ะฟัะพะฒะตัะบะธ ะบะฐะถะดะพะณะพ ัะฐะณะฐ
3. **ะกะผะพััะธัะต [VARIABLES_REFERENCE.md](./VARIABLES_REFERENCE.md)** - ะดะปั ะฝะฐัััะพะนะบะธ ะฟะตัะตะผะตะฝะฝัั
4. **ะงะธัะฐะนัะต [GITHUB_ACTIONS_SETUP.md](./GITHUB_ACTIONS_SETUP.md)** - ะดะปั ะดะตัะฐะปัะฝะพะน ะธะฝัะพัะผะฐัะธะธ

## ๐ ะัะฝะพะฒะฝัะต ัะฐะณะธ ะฝะฐัััะพะนะบะธ

### 1. ะะพะดะณะพัะพะฒะบะฐ ัะตัะฒะตัะฐ

- ะฃััะฐะฝะพะฒะบะฐ Docker ะธ Docker Compose
- ะกะพะทะดะฐะฝะธะต ะฟะพะปัะทะพะฒะฐัะตะปั `deploy`
- ะะฐัััะพะนะบะฐ ะฟัะฐะฒ ะดะพัััะฟะฐ

**ะกะผ. ะฟะพะดัะพะฑะฝะพััะธ:** [CI_CD.md](./CI_CD.md#ะฟะพะดะณะพัะพะฒะบะฐ-ัะตัะฒะตัะฐ-ะพะดะฝะพะบัะฐัะฝะพ)

### 2. ะฃััะฐะฝะพะฒะบะฐ Self-hosted Runner

- ะะพะฑะฐะฒะปะตะฝะธะต runner ะฒ GitHub
- ะฃััะฐะฝะพะฒะบะฐ ะฝะฐ ัะตัะฒะตัะต
- ะะฐัััะพะนะบะฐ ะบะฐะบ systemd service

**ะกะผ. ะฟะพะดัะพะฑะฝะพััะธ:** [CI_CD.md](./CI_CD.md#ัััะฐะฝะพะฒะบะฐ-self-hosted-runner-repo-level)

### 3. ะกะพะทะดะฐะฝะธะต ัะฐะนะปะฐ ะพะบััะถะตะฝะธั

- ะะพะฟะธัะพะฒะฐะฝะธะต ะฟัะธะผะตัะฐ ะธะท `ENV_PRODUCTION.example`
- ะะฐะฟะพะปะฝะตะฝะธะต ะพะฑัะทะฐัะตะปัะฝัั ะฟะตัะตะผะตะฝะฝัั
- ะะฐัััะพะนะบะฐ ะฟัะฐะฒ ะดะพัััะฟะฐ

**ะกะผ. ะฟะพะดัะพะฑะฝะพััะธ:** [VARIABLES_REFERENCE.md](./VARIABLES_REFERENCE.md)

### 4. ะัะพะฒะตัะบะฐ ัะฐะฑะพัะพัะฟะพัะพะฑะฝะพััะธ

- ะขะตััะธัะพะฒะฐะฝะธะต CI pipeline
- ะขะตััะธัะพะฒะฐะฝะธะต Deploy pipeline
- ะัะพะฒะตัะบะฐ health endpoints

**ะกะผ. ะฟะพะดัะพะฑะฝะพััะธ:** [QUICK_START.md](./QUICK_START.md#ัะฐะณ-4-ะฟัะพะฒะตัะบะฐ-ัะฐะฑะพัะพัะฟะพัะพะฑะฝะพััะธ)

## ๐ง ะััะธัะตะบัััะฐ CI/CD

```
โโโโโโโโโโโโโโโโโโโ
โ   Push/PR       โ
โโโโโโโโโโฌโโโโโโโโโ
         โ
         โผ
โโโโโโโโโโโโโโโโโโโ
โ   CI Pipeline   โ
โ  โโโโโโโโโโโโโ  โ
โ  โ Backend   โ  โ  (pytest)
โ  โ Tests     โ  โ
โ  โโโโโโโโโโโโโ  โ
โ  โโโโโโโโโโโโโ  โ
โ  โ Frontend โ  โ  (lint, type-check, jest)
โ  โ Checks   โ  โ
โ  โโโโโโโโโโโโโ  โ
โโโโโโโโโโฌโโโโโโโโโ
         โ
         โผ (ัะพะปัะบะพ ะฝะฐ main)
โโโโโโโโโโโโโโโโโโโ
โ Deploy Pipeline โ
โ  โโโโโโโโโโโโโ  โ
โ  โ  Build    โ  โ  (GitHub-hosted runner)
โ  โ  Images   โ  โ  โ GHCR
โ  โโโโโโโโโโโโโ  โ
โ  โโโโโโโโโโโโโ  โ
โ  โ  Deploy   โ  โ  (self-hosted runner)
โ  โ  Server   โ  โ  โ /opt/colaba
โ  โโโโโโโโโโโโโ  โ
โโโโโโโโโโโโโโโโโโโ
```

**ะกะผ. ะฟะพะดัะพะฑะฝะพััะธ:** [CI_CD.md](./CI_CD.md#ะบะฐะบ-ัะฐะฑะพัะฐะตั)

## ๐ฆ ะงัะพ ะดะตะฟะปะพะธััั

ะัะธ ะดะตะฟะปะพะต ะฝะฐ ัะตัะฒะตั ะบะพะฟะธัััััั:

- `docker-compose.prod.yml` โ `/opt/colaba/docker-compose.prod.yml`
- `scripts/deployment/deploy.sh` โ `/opt/colaba/scripts/deployment/deploy.sh`

ะกะบัะธะฟั ะดะตะฟะปะพั ะฒัะฟะพะปะฝัะตั:

1. ะะพะดะฝะธะผะฐะตั ะธะฝััะฐััััะบัััั (postgres, redis)
2. ะกะบะฐัะธะฒะฐะตั ะพะฑัะฐะทั ะธะท GHCR
3. ะะฐะฟััะบะฐะตั ะผะธะณัะฐัะธะธ Alembic
4. ะะฐะฟััะบะฐะตั ะฒัะต ัะตัะฒะธัั
5. ะัะพะฒะตััะตั health endpoints

**ะกะผ. ะฟะพะดัะพะฑะฝะพััะธ:** [CI_CD.md](./CI_CD.md#ััะพ-ะธะผะตะฝะฝะพ-ะดะตะฟะปะพะธััั-ะฝะฐ-ัะตัะฒะตั)

## ๐ ะะตะทะพะฟะฐัะฝะพััั

### ะะฑัะทะฐัะตะปัะฝัะต ะผะตัั:

1. โ ะคะฐะนะป `.env` ะฝะต ะบะพะผะผะธัะธััั ะฒ ัะตะฟะพะทะธัะพัะธะน
2. โ ะัะฟะพะปัะทััััั ะฝะฐะดะตะถะฝัะต ะฟะฐัะพะปะธ
3. โ `SECRET_KEY` ะณะตะฝะตัะธััะตััั ัะปััะฐะนะฝัะผ ะพะฑัะฐะทะพะผ
4. โ ะัะฐะฒะธะปัะฝัะต ะฟัะฐะฒะฐ ะดะพัััะฟะฐ ะบ ัะฐะนะปะฐะผ
5. โ ะะณัะฐะฝะธัะตะฝะฝัะน ะดะพัััะฟ ะบ self-hosted runner

**ะกะผ. ะฟะพะดัะพะฑะฝะพััะธ:** [GITHUB_ACTIONS_SETUP.md](./GITHUB_ACTIONS_SETUP.md#ะฑะตะทะพะฟะฐัะฝะพััั)

## ๐ Troubleshooting

### ะัะพะฑะปะตะผั ั runner:

```bash
cd /opt/actions-runner
sudo ./svc.sh status
sudo ./svc.sh restart
sudo journalctl -u actions.runner.* -f
```

### ะัะพะฑะปะตะผั ั ะดะตะฟะปะพะตะผ:

1. ะัะพะฒะตัััะต ะปะพะณะธ ะฒ GitHub Actions
2. ะัะพะฒะตัััะต ัะฐะนะป `/opt/colaba/.env`
3. ะัะพะฒะตัััะต ััะฐััั ะบะพะฝัะตะนะฝะตัะพะฒ:
   ```bash
   cd /opt/colaba
   docker compose -f docker-compose.prod.yml ps
   docker compose -f docker-compose.prod.yml logs
   ```

**ะกะผ. ะฟะพะดัะพะฑะฝะพััะธ:** 
- [GITHUB_ACTIONS_SETUP.md](./GITHUB_ACTIONS_SETUP.md#troubleshooting)
- [CHECKLIST.md](./CHECKLIST.md#-ะตัะปะธ-ััะพ-ัะพ-ะฝะต-ัะฐะฑะพัะฐะตั)

## ๐ ะะพะฝะธัะพัะธะฝะณ

### ะัะพะฒะตัะบะฐ ััะฐัััะฐ:

```bash
# ะะพะฝัะตะนะฝะตัั
cd /opt/colaba
docker compose -f docker-compose.prod.yml ps

# ะะพะณะธ
docker compose -f docker-compose.prod.yml logs -f

# Health checks
curl http://localhost:8000/health
curl http://localhost:3000/
```

### GitHub Actions:

- ะะตัะตะนะดะธัะต ะฒ **Actions** ะฒ ัะตะฟะพะทะธัะพัะธะธ
- ะัะพัะผะพััะธัะต ะธััะพัะธั ะทะฐะฟััะบะพะฒ
- ะัะพะฒะตัััะต ะปะพะณะธ ะบะฐะถะดะพะณะพ job

## ๐ ะะพะปะตะทะฝัะต ัััะปะบะธ

- [GitHub Actions Documentation](https://docs.github.com/en/actions)
- [Self-hosted runners](https://docs.github.com/en/actions/hosting-your-own-runners)
- [GitHub Container Registry](https://docs.github.com/en/packages/working-with-a-github-packages-registry/working-with-the-container-registry)
- [Docker Compose Documentation](https://docs.docker.com/compose/)

## ๐ Workflow ัะฐะนะปั

- `.github/workflows/ci.yml` - CI pipeline
- `.github/workflows/deploy.yml` - Deploy pipeline
- `scripts/deployment/deploy.sh` - ะกะบัะธะฟั ะดะตะฟะปะพั
- `docker-compose.prod.yml` - Docker Compose ะบะพะฝัะธะณััะฐัะธั

## โ ะะพะฟัะพัั?

ะัะปะธ ั ะฒะฐั ะฒะพะทะฝะธะบะปะธ ะฒะพะฟัะพัั:

1. ะัะพะฒะตัััะต [CHECKLIST.md](./CHECKLIST.md) - ะฒะพะทะผะพะถะฝะพ, ััะพ-ัะพ ะฟัะพะฟััะตะฝะพ
2. ะะทััะธัะต [Troubleshooting](./GITHUB_ACTIONS_SETUP.md#troubleshooting)
3. ะัะพะฒะตัััะต ะปะพะณะธ ะฒ GitHub Actions ะธ ะฝะฐ ัะตัะฒะตัะต
4. ะฃะฑะตะดะธัะตัั, ััะพ ะฒัะต ะฟะตัะตะผะตะฝะฝัะต ะพะบััะถะตะฝะธั ะทะฐะฟะพะปะฝะตะฝั ะฟัะฐะฒะธะปัะฝะพ

## ๐ ะะฐะถะฝัะต ะทะฐะผะตัะฐะฝะธั

- โ๏ธ Self-hosted runner ะดะพะปะถะตะฝ ะฑััั ะทะฐะฟััะตะฝ ะธ ะพะฝะปะฐะนะฝ ะดะปั ัะฐะฑะพัั ะดะตะฟะปะพั
- โ๏ธ ะคะฐะนะป `.env` ะดะพะปะถะตะฝ ัััะตััะฒะพะฒะฐัั ะฝะฐ ัะตัะฒะตัะต ะฟะตัะตะด ะฟะตัะฒัะผ ะดะตะฟะปะพะตะผ
- โ๏ธ ะะตะฟะปะพะน ะทะฐะฟััะบะฐะตััั ัะพะปัะบะพ ะฟะพัะปะต ััะฟะตัะฝะพะณะพ CI ะฝะฐ ะฒะตัะบะต `main`
- โ๏ธ ะะฑัะฐะทั ะฟัะฑะปะธะบััััั ะฒ GHCR ะฐะฒัะพะผะฐัะธัะตัะบะธ ะฟัะธ ะดะตะฟะปะพะต
